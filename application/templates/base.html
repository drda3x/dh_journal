<!DOCTYPE html>
<html ng-app="DynamicTeacherApp">
    {% load staticfiles %}
    <head>
        <title>ТСК "Динамика" - электронный журнал</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="{% static "bootstrap/css/bootstrap.css" %}"/>
        <link rel="stylesheet" href="{% static "bootstrap/css/bootstrap-responsive.css" %}"/>
        <link rel="stylesheet" href="{% static "css/main.css" %}"/>
        <link rel="stylesheet" href="{% static "css/datepicker.css" %}"/>
        <link rel="stylesheet" href="{% static "shortcard/short_card.css" %}"/>
        <link rel="stylesheet" href="{% static "alert/alert.css" %}"/>
        <link rel="stylesheet" href="{% static  "css/angular-datepicker.css" %}" type="text/css" />
        <script type="text/javascript" src="{% static "js/jquery.js" %}"></script>
        <script type="text/javascript" src="{% static "js/angular.min.js" %}"></script>
        <script type="text/javascript" src="{% static "js/jquery.cookie.js" %}"></script>
        <script type="text/javascript" src="{% static "js/underscore.js" %}"></script>
        <script type="text/javascript" src="{% static "js/moment.js" %}"></script>

        <script type="text/javascript" src="{% static "js/app.js" %}"></script>
        <script type="text/javascript" src="{% static "js/directives/focus_me.js" %}"></script>
        <script type="text/javascript" src="{% static "js/filters/filters.js" %}"></script>
        <script type="text/javascript" src="{% static "js/pages/main_page.js" %}"></script>

        <script type="text/javascript" src="{% static "bootstrap/js/bootstrap.js" %}"></script>
        <script type="text/javascript" src="{% static "bootstrap/js/bootstrap-datepicker.js" %}"></script>
        <script type="text/javascript" src="{% static "shortcard/short_card.js" %}"></script>
        <script type="text/javascript" src="{% static "alert/alert.js" %}"></script>
        <script type="text/javascript" src="{% static "js/angular-datepicker.js" %}"></script>
        <script type="text/javascript" src="https://cdn.rawgit.com/Luegg/angularjs-scroll-glue/master/src/scrollglue.js"></script>
        <script type="text/javascript">
            var csrftoken = $.cookie('csrftoken');

            function csrfSafeMethod(method) {
                // these HTTP methods do not require CSRF protection
                return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
            }

            $.ajaxSetup({
                beforeSend: function(xhr, settings) {
                    if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                        xhr.setRequestHeader("X-CSRFToken", csrftoken);
                    }
                }
            });
           
            window.sideBarInit({{menu | safe}})
        </script>
        <style>
            .carret {
                border: 10px solid transparent;
                width: 0;
                height: 0;
                border-right: 15px solid #999999;
            }
            .carret-left {
                border: 10px solid transparent;
                width: 0;
                height: 0;
                border-left: 15px solid #999999;
            }
            .toggle-button {
                display: block; 
                float: right; 
                margin: -20px; 
                background-color: #e3e3e3; 
                padding: 10px 16px 10px 4px; 
                border-radius: 3px;
            }
            .toggle-button:hover {
                background-color: #999999; 
            }
            .toggle-button:hover .carret {
                border-right: 15px solid #e3e3e3;
            }
            .toggle-button:hover .carret-left {
                border-left: 15px solid #e3e3e3;
            }
            .sidebar-header {
                border-bottom: 1px solid;
            }
            .sidebar-header .carret {
                border: 6px solid transparent;
                border-right: 10px solid #999999;
                display: inline;
                float: right;
                margin-top: 3px;
            }
            .sidebar-header .carret2 {
                border: 6px solid transparent;
                border-top: 10px solid #999999;
                display: inline;
                float: right;
                margin-top: 5px;
            }

        </style>
        {% block head %}
            {% block style%}
            {% endblock %}
            {% block script %}
            {% endblock %}
        {% endblock %}
    </head>
    <body >
            {% block body %}
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="navbar">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        </a>
                        <a href="#" class="brand visible-desktop">ТСК "Динамика". Электронный журнал</a>
                        <a href="#" class="brand hidden-desktop">ТСК "Динамика". ЭЖ</a>
                        {% if user.id %}
                            <div class="nav-collapse collapse">
                                <div class="pull-right dropdown header-right" style="position: relative">
                                    <a class="navbar-link dropdown-toggle" href="#" data-toggle="dropdown" role="button" type="button">{{user.last_name}} {{user.first_name}}<b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    <li><a href="http://{{host}}/profile?uid=-100" id="userProfile" tabindex="-1">Профиль</a></li>
                                    <li><a href="http://{{host}}/logout" tabindex="-1">Выход</a></li>
                                </ul>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                </div>
                </div>
            </div>
            {% if user.id != None %}            
                {% verbatim %}
                <div class="row-fluid"  ng-controller="sideBarCtrl">
                <div ng-show="toggleSideBar_local" ng-class="{span2: toggleSideBar_local,  'visible-desktop': isAnyPageOpened}" class="well">
                        <div>
                            <a class="toggle-button" 
                                style="" 
                                href="" 
                                ng-show="isAnyPageOpened"
                                ng-click="setSideBarStatus(false)">
                                    <div class="carret"></div>
                            </a>
                            
                        </div>
                        <ul class="nav nav-list" ng-show="toggleSideBar">
                            <li ng-class="calcClasses(menu_elem)" ng-repeat="menu_elem in sidebar_menu track by $index" class="nav-group">
                                <!--
                                <span ng-if="isHeader(menu_elem)">{{menu_elem.label}}
                                    <a style="cursor: pointer" ng-show="menu_elem.hideable && !checkIndex($index)" ng-click="hideMenuPart($index)">скрыть</a>
                                    <a style="cursor: pointer" ng-show="menu_elem.hideable && checkIndex($index)" ng-click="showMenuPart($index)">показать</a>
                                </span>
                                -->
                                <a href="" class="sidebar-header" ng-if="isHeader(menu_elem)" ng-click="toggleMenuPart($index)">
                                    {{menu_elem.label}} 
                                    <div ng-show="menu_elem.hideable && checkIndex($index)" class="carret"></div>  
                                    <div ng-show="menu_elem.hideable && !checkIndex($index)" class="carret2"></div>  
                                </a>

                                <a ng-class="{'nav-group-link': menu_elem.show, 'bad_profit': (menu_elem.profit<0), 'good_profit': (menu_elem.profit>0)}"
                                    ng-show="menu_elem.show" 
                                    style="color: #000"
                                    ng-if="!isHeader(menu_elem)"  
                                    href="{%endverbatim%}http://{{host}}/{%verbatim%}{{menu_elem.url}}"
                                    ng-bind-html="menu_elem.label">
                                </a>
                            </li>
                        </ul>
                    </div>
                {% endverbatim %}
            {%endif%}
                {% block content %}
                {% endblock %}
            </div>
        </div>
            {% endblock %}
    </body>
</html>
